USE DATABASE SIM_BOM;

CREATE OR REPLACE STAGE SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES;

PUT file://C:/Users/soundharrajan/Documents/SIM_BOM_CSV_FILE/ITEM.csv @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES;
PUT file://C:/Users/soundharrajan/Documents/SIM_BOM_CSV_FILE/LOCATION.csv @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES;
PUT file://C:/Users/soundharrajan/Documents/SIM_BOM_CSV_FILE/ORIG_BOM.csv @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES;

CREATE OR REPLACE FILE FORMAT CSV_FILE_FORMAT
TYPE = 'CSV'
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
SKIP_HEADER = 1;

COPY INTO SIM_BOM.MASTER_DATA.ITEM
FROM @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES/ITEM.csv
FILE_FORMAT = (FORMAT_NAME = 'CSV_FILE_FORMAT', TYPE = CSV);

COPY INTO SIM_BOM.MASTER_DATA.LOCATION
FROM @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES/LOCATION.csv
FILE_FORMAT = (FORMAT_NAME = 'CSV_FILE_FORMAT', TYPE = CSV);

COPY INTO SIM_BOM.MASTER_DATA.ORIG_BOM
FROM @SIM_BOM.BMATHUB_BASE.CSV_STAGED_FILES/ORIG_BOM.csv
FILE_FORMAT = (FORMAT_NAME = 'CSV_FILE_FORMAT', TYPE = CSV);

